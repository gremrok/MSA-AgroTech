@startuml Контекстная диаграмма C4 - Основное решение
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

Title Контекстная диаграмма C4 - Основное решение 

Person(дежурный, "Дежурный", "Мониторинг состояния поголовья и оборудования фермы, реагирование на тревоги")
Person(инженер, "Инженер", "Обслуживает локальное оборудование, получает локальные уведомления")
Person(аналитик, "Аналитик", "Анализ эффективности ферм, интеграция с общими бизнес-метриками")

System_Boundary(агротех_x, "Цифровая платформа «АгроТех Х» (Существующая)") {
    System(агропром_платформа, "АгроПром Х - Цифровая платформа", "ERP, BI, данные по растениеводству и технике")
    System(центральный_kafka, "Центральная шина данных (Kafka)", "Единый поток событий для всех систем холдинга")
    System(центральное_хранилище, "Центральное хранилище данных", "DWH/Data Lake")
    System(единый_bi, "Единая BI-система (Power BI)", "Консолидированные отчеты по всему холдингу")
}

System_Boundary(новая_платформа, "Новая система (MVP)") {
    System(фермерский_портал, "Фермерский веб-портал / Мобильное приложение", "Интерфейс для мониторинга в реальном времени, управления кормушками, просмотра тревог и отчетов")
    System(облачный_сервис_животноводство, "Облачный сервис управления животноводством", "Обработка и агрегация данных со всех ферм, бизнес-логика, долгосрочная аналитика, управление пользователями")
    System(центральный_сервер, "Центральный сервер (на каждой ферме)", "Локальная база данных, обработка видеоаналитики в реальном времени, управление edge-устройствами, автономная работа")
    System(edge_агенты, "Edge-агенты и устройства", "Камеры с ИИ-обработкой, контроллеры кормушек/поилок, датчики воды, IoT-шлюзы (LoRaWAN, WiFi)")
}

' Связи между людьми и системами
Rel(дежурный, фермерский_портал, "Использует для ежедневного контроля", "HTTPS/WebSocket")
Rel(инженер, edge_агенты, "Обслуживает, настраивает локально", "Локальная сеть")
Rel(аналитик, единый_bi, "Анализирует интегрированные данные", "Power BI")

' Связи внутри новой платформы
Rel(edge_агенты, центральный_сервер, "Передает данные и видеостримы", "Локальная сеть (Ethernet/WiFi/LoRa), RTSP, MQTT")
Rel(центральный_сервер, фермерский_портал, "Стриминг видео, актуальный статус, тревоги", "WebSocket, HTTPS (через облако или напрямую при автономной работе)" )
Rel(центральный_сервер, облачный_сервис_животноводство, "Синхронизация агрегированных данных, конфигурации, логов", "HTTPS/MQTT (с очередью при обрыве связи)")
Rel(облачный_сервис_животноводство, фермерский_портал, "Предоставляет интерфейс, исторические данные, настройки", "HTTPS/API")

' Интеграция с существующей платформой
Rel(облачный_сервис_животноводство, центральный_kafka, "Публикует ключевые бизнес-события (расход корма, падеж, тревоги)", "Kafka Protocol")
Rel(центральный_kafka, центральное_хранилище, "Поступление данных для долгосрочного хранения", "ETL")
Rel(центральное_хранилище, единый_bi, "Источник данных для отчетов", "ODBC/SQL")
Rel(агропром_платформа, единый_bi, "Предоставляет данные по другим направлениям", "Интеграция")

' Внешние системы
System_Ext(нейросеть_партнеров, "Сервис нейросетевых моделей (Партнеры)", "Предоставляет обновляемые модели для детекции и трекинга животных")
Rel(центральный_сервер, нейросеть_партнеров, "Запросы для сложной аналитики / периодическое обновление моделей", "HTTPS (опционально)")

@enduml